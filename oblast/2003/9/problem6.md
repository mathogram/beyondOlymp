Пусть $a_n=n^2+500$  и $d_n=2+{\mathop{\hbox{НОД}}\nolimits}(a_n, a_{n+1})$ для любого натурального $n$. Определите наибольшее значение $d_n$.